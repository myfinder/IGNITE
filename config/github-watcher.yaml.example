# GitHub Watcher 設定
# このファイルをコピーして github-watcher.yaml として使用してください
# cp config/github-watcher.yaml.example config/github-watcher.yaml
#
# 詳細は docs/github-watcher.md を参照してください

# 自動起動設定
auto_start:
  # ignite start 時に自動起動するか
  # --with-watcher / --no-watcher オプションで上書き可能
  enabled: false

watcher:
  # 監視対象リポジトリ（owner/repo 形式で指定）
  # 複数リポジトリを監視可能
  # base_branch を指定しない場合はリポジトリのデフォルトブランチを使用
  repositories:
    - repo: owner/repo1
      # base_branch: main    # 省略時はリポジトリのデフォルトブランチを使用
    # - repo: owner/repo2
    #   base_branch: develop
    # - repo: organization/repo3
    #   base_branch: main
    #
    # ワイルドカードパターン指定（Organization API で展開）
    # Organization内の命名規則に一致するリポジトリを一括監視
    # 起動時に展開され、デーモンモードでは定期的にリフレッシュされる
    # - pattern: "organization/project-*"
    # - pattern: "organization/backend-service-*"

  # ポーリング間隔（秒）
  # GitHub API レート制限に注意してください
  # 認証済みの場合: 5000 requests/hour
  # 推奨: 60秒以上
  interval: 60
  # パターンリフレッシュ間隔（ポーリング回数。デフォルト: 60 ≈ 約1時間）
  # pattern_refresh_interval: 60

  # 監視するイベントタイプ
  events:
    # Issue の作成を監視
    issues: true

    # Issue へのコメントを監視
    issue_comments: true

    # Pull Request の作成を監視
    pull_requests: true

    # Pull Request へのコメント（レビューコメント含む）を監視
    pr_comments: true

  # Bot が投稿したイベントを無視する
  # true にすると、自分自身の Bot 投稿に反応しなくなります
  ignore_bot: true


# トリガー設定
# メンションやキーワードで特定のアクションを実行
triggers:
  # メンションパターン（正規表現として解釈）
  # このパターンがコメントに含まれている場合、タスクメッセージを生成
  mention_pattern: "@ignite-gh-app"

  # トリガーキーワード
  # メンション後のキーワードでアクションタイプを判別
  keywords:
    # 実装タスクをトリガーするキーワード
    implement:
      - "実装して"
      - "implement"
      - "fix this"
      - "PRを作成"
      - "PR作成"
      - "このIssueを解決"

    # レビュータスクをトリガーするキーワード
    review:
      - "レビューして"
      - "review"
      - "確認して"
      - "チェックして"

    # 説明タスクをトリガーするキーワード
    explain:
      - "説明して"
      - "explain"
      - "解説して"
      - "教えて"

    # メモリ分析（Insights）をトリガーするキーワード
    insights:
      - "インサイト"
      - "insights"
      - "insight"
      - "メモリ分析"

  # 自動トリガー（ラベルベース）
  # これらのラベルが付いた Issue は自動的に処理対象になります
  auto_labels:
    - "ignite-auto"
    - "help-wanted"
    - "good-first-issue"

# 応答設定
responses:
  # タスク受付時に自動でコメントする
  acknowledge: true

  # 受付コメントのテンプレート
  acknowledge_template: |
    このIssueを確認しました。処理を開始します。

    ---
    *Generated by IGNITE AI Team*

  # 成功時に自動でコメントする
  report_success: true

  # 成功コメントのテンプレート
  # {details} は実際のコンテキストに置換されます
  success_template: |
    ✅ 処理が完了しました！

    {details}

    ---
    *Generated by IGNITE AI Team*

  # エラー時に自動でコメントする
  report_errors: true

  # エラーコメントのテンプレート
  # {error_message} は実際のエラー内容に置換されます
  error_template: |
    ❌ 処理中にエラーが発生しました。

    **エラー内容:**
    {error_message}

    ---
    *Generated by IGNITE AI Team*

  # 進捗報告（オプション）
  report_progress: false

  # 進捗コメントのテンプレート
  # {status} は現在の状況に置換されます
  progress_template: |
    ⏳ 処理中...

    {status}

    ---
    *Generated by IGNITE AI Team*

# アクセス制御
# タスクトリガー（@ignite-gh-app）を許可するユーザーを制限
access_control:
  # true: ホワイトリストのユーザーのみ許可
  # false: 全員許可
  enabled: true

  # 許可ユーザーリスト（GitHubユーザー名）
  # enabled: true の場合のみ有効
  allowed_users:
    # - "admin-user"
    # - "trusted-developer"
